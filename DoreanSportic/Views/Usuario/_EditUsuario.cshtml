@model DoreanSportic.Web.ViewModels.RegistroViewModel
@using Microsoft.AspNetCore.Mvc.Localization
@inject IViewLocalizer Localizer
@{
    Layout = null;
}

<form id="formEditUsuario" asp-action="Edit" asp-controller="Usuario" asp-antiforgery="true" method="post"
      onsubmit="return manejarSubmitUsuarioEdit(event)"
      class="space-y-4 p-2 bg-base-100 rounded-xl shadow-lg">

    <input type="hidden" asp-for="Id" />
    <input type="hidden" asp-for="IdCliente" />

    <!-- Header -->
    <div class="flex flex-col gap-2 mb-3">
        <a href="javascript:void(0);" class="btn btn-sm btn-outline bg-[#006400] text-white w-50"
           onclick="cargarVista('/Usuario/IndexAdmin')">
            @(Localizer["Volver al listado"])
        </a>
        <h2 class="text-left font-bold">
            @(Localizer["EDITAR USUARIO"])
        </h2>
    </div>

    <div class="flex flex-row gap-4 w-full">
        <div asp-validation-summary="ModelOnly" class="text-sm italic" style="color:red; font-size: small"></div>

        <!-- Columna 1 -->
        <div class="w-2/3 flex flex-col gap-4">
            <!-- Nombre -->
            <div class="form-control w-full">
                <label asp-for="Nombre" class="label">
                    <span class="label-text font-bold text-black">@Localizer["Nombre"]</span>
                </label>
                <input asp-for="Nombre" class="input input-bordered w-full mb-1 mt-1" style="border-color:black" />
                <span asp-validation-for="Nombre" class="text-sm italic" style="color:red; font-size: small"></span>
            </div>

            <!-- Apellido -->
            <div class="form-control w-full">
                <label asp-for="Apellido" class="label">
                    <span class="label-text font-bold text-black">@Localizer["Apellido"]</span>
                </label>
                <input asp-for="Apellido" class="input input-bordered w-full mb-1 mt-1" style="border-color:black" />
                <span asp-validation-for="Apellido" class="text-sm italic" style="color:red; font-size: small"></span>
            </div>

            <!-- Email -->
            <div class="form-control w-full">
                <label asp-for="Email" class="label">
                    <span class="label-text font-bold text-black">@Localizer["Correo electrónico"]</span>
                </label>
                <input asp-for="Email" type="email" class="input input-bordered w-full mb-1 mt-1" style="border-color:black" />
                <span asp-validation-for="Email" class="text-sm italic" style="color:red; font-size: small"></span>
            </div>

            <!-- Teléfono + Sexo -->
            <div class="flex flex-row gap-4">
                <div class="form-control w-full">
                    <label asp-for="Telefono" class="label">
                        <span class="label-text font-bold text-black">@Localizer["Teléfono (opcional)"]</span>
                    </label>
                    <input asp-for="Telefono" class="input input-bordered w-full mb-1 mt-1" style="border-color:black" />
                    <span asp-validation-for="Telefono" class="text-sm italic" style="color:red; font-size: small"></span>
                </div>
                <div class="form-control w-full">
                    <label asp-for="IdSexo" class="label">
                        <span class="label-text font-bold text-black">@Localizer["Sexo (opcional)"]</span>
                    </label>
                    <select asp-for="IdSexo" asp-items="Model.Sexos" class="select select-bordered w-full mb-1 mt-1" style="border-color:black">
                        <option value="3">-- @Localizer["Seleccione"] --</option>
                    </select>
                </div>
            </div>

            <!-- Usuario + Rol -->
            <div class="flex flex-row gap-4">
                <div class="form-control w-full">
                    <label asp-for="UserName" class="label">
                        <span class="label-text font-bold text-black">@Localizer["Nombre de usuario"]</span>
                    </label>
                    <input asp-for="UserName" class="input input-bordered w-full mb-1 mt-1" style="border-color:black" readonly />
                    <span asp-validation-for="UserName" class="text-sm italic" style="color:red; font-size: small"></span>
                </div>
                <div class="form-control w-full">
                    <label asp-for="IdTipoUsuario" class="label">
                        <span class="label-text font-bold text-black">@Localizer["Rol de usuario"]</span>
                    </label>
                    <select asp-for="IdTipoUsuario" asp-items="Model.TiposUsuario" class="select select-bordered w-full mb-1 mt-1" style="border-color:black">
                        <option value="0">-- @Localizer["Seleccione"] --</option>
                    </select>
                    <span asp-validation-for="IdTipoUsuario" class="text-sm italic" style="color:red; font-size: small"></span>
                </div>
            </div>

            <!-- Contraseña y confirmar contraseña en fila -->
            <div class="flex flex-row gap-4">

                <div class="form-control w-full">
                    <label asp-for="Password" class="label">
                        <span class="label-text font-bold text-black">@Localizer["Contraseña"]</span>
                    </label>
                    <input asp-for="Password" type="password" class="input input-bordered w-full mb-1 mt-1" style="border-color:black" />
                    <span asp-validation-for="Password" class="text-sm italic" style=" color:red; font-size: small"></span>
                </div>

                <div class="form-control w-full">
                    <label asp-for="ConfirmPassword" class="label">
                        <span class="label-text font-bold text-black">@Localizer["Confirmar contraseña"]</span>
                    </label>
                    <input asp-for="ConfirmPassword" type="password" class="input input-bordered w-full mb-1 mt-1" style="border-color:black" />
                    <span asp-validation-for="ConfirmPassword" class="text-sm italic" style="color:red; font-size: small"></span>
                </div>
            </div>

            <!-- Toggle Estado -->
            <div class="form-control w-fit">
                <label class="label">
                    <span class="label-text font-bold text-black mb-1">@Localizer["Estado"]</span>
                </label>
                <div class="flex items-center gap-2">
                    <span>@Localizer["Inactivo"]</span>
                    <!-- Fallback para enviar false cuando el checkbox no se marca -->
                    <input type="hidden" name="_Estado" value="false" />
                    <input type="checkbox"
                           name="Estado"
                           class="toggle border-black bg-white checked:border-primary checked:bg-primary checked:text-white"
                           value="true" @(Model.Estado ? "checked" : "") />
                    <span>@Localizer["Activo"]</span>
                </div>
            </div>

            <!-- Botón -->
            <div class="form-control mt-4">
                <button type="submit" class="btn btn-primary w-full">@Localizer["Guardar cambios"]</button>
            </div>
        </div>

        <!-- Columna 2 (ayudas) -->
        <div class="flex flex-col gap-2 w-1/3">
            <div class="w-full">
                <p class="font-bold italic">@Localizer["Información"]</p>
                <p class="text-sm">@Localizer["Puede actualizar correo, teléfono, sexo, rol y estado del usuario."]</p>
            </div>
        </div>
    </div>
</form>

<!-- Mensajes para JS -->
<div id="mensajes-internacionalizados-usuario-edit" class="hidden"
     data-ok='@Localizer["Usuario actualizado correctamente"]'
     data-errorForm='@Localizer["Corrige los errores del formulario"]'
     data-errorInesperado='@Localizer["Error inesperado"]'>
</div>
